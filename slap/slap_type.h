///////////////////////////////////////////////////////////////////////////////////////////////////
#ifndef SLAP_TYPE_H
#define SLAP_TYPE_H

///////////////////////////////////////////////////////////////////////////////////////////////////
#include <string>
#include <vector>

///////////////////////////////////////////////////////////////////////////////////////////////////
struct ldapmod;
typedef ldapmod LDAPMod;

struct ldap;
typedef ldap LDAP;

///////////////////////////////////////////////////////////////////////////////////////////////////
namespace slap
{

///////////////////////////////////////////////////////////////////////////////////////////////////
typedef LDAP* ldap;

///////////////////////////////////////////////////////////////////////////////////////////////////
struct mod_deleter
{
    void operator()(LDAPMod* mod);
};

typedef std::unique_ptr<LDAPMod, mod_deleter> mod;

slap::mod to_mod(int op, const std::string& type, const std::vector<std::string>& values);

///////////////////////////////////////////////////////////////////////////////////////////////////
typedef std::unique_ptr<LDAPMod*[]> modpp;

///////////////////////////////////////////////////////////////////////////////////////////////////
}

///////////////////////////////////////////////////////////////////////////////////////////////////
#endif // SLAP_TYPE_H
