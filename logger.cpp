///////////////////////////////////////////////////////////////////////////////////////////////////
// Copyright (c) 2014 Dimitry Ishenko
// Distributed under the GNU GPL v2. For full terms please visit:
// http://www.gnu.org/licenses/gpl.html
//
// Contact: dimitry (dot) ishenko (at) (gee) mail (dot) com

///////////////////////////////////////////////////////////////////////////////////////////////////
#include "logger.h"

///////////////////////////////////////////////////////////////////////////////////////////////////
namespace app
{

///////////////////////////////////////////////////////////////////////////////////////////////////
void log::logbuf_base::putchar(char c)
{
    if(c == endl)
    {
        syslog(_M_level, "%s", _M_buffer.data());

        _M_buffer.clear();
        _M_level= default_level;
    }
    else _M_buffer+= c;
}

///////////////////////////////////////////////////////////////////////////////////////////////////
log::logbuf_base::~logbuf_base()
{
    if(_M_buffer.size()) putchar(endl);
}

///////////////////////////////////////////////////////////////////////////////////////////////////
log::stream logger;

///////////////////////////////////////////////////////////////////////////////////////////////////
}
